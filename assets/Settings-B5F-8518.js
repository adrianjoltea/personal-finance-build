import{h as C,i as P,w as S,_ as g,x as N,r as f,j as e,B as E,e as F,a as $,y as h}from"./index-pnElvbLb.js";function A(){const a=C(),{mutate:s,isPending:t}=P({mutationFn:n=>S(n),onSuccess:()=>{g.success("User updated succesfully",{className:"toast"}),a.invalidateQueries({queryKey:["user"]})},onError:n=>g.error(n.message,{className:"toast"})});return{isPending:t,updateCurrentUser:s}}function D(a,s){if(!a||!s)return"Please select an avatar and fill the username"}function I(a,s){const t=D(a,s);return t?(g.error(t,{className:"toast"}),!0):!1}function L({avatar:a,firstName:s,lastName:t,handleFileChange:n}){const{user:r}=N(),l=r==null?void 0:r.profilePicture,[p,o]=f.useState(null),x=`${F}/${l||""}`,c=r==null?void 0:r.username;return f.useEffect(()=>{if(a){const u=new FileReader;u.onload=v=>{var m;typeof((m=v.target)==null?void 0:m.result)=="string"&&o(v.target.result)},u.readAsDataURL(a)}else o(null)},[a]),e.jsx("div",{className:"profile-preview",children:e.jsxs("div",{className:"profile-preview-container",children:[p||l?e.jsxs("label",{className:"profile-preview-container-img",children:[e.jsx("input",{id:"avatarInput",type:"file",className:"profile-preview-container-btn-input",onChange:n}),e.jsx(E,{className:"profile-preview-container-btn-camera"}),e.jsx("img",{src:p||x,alt:"avatar"})]}):e.jsx("p",{children:"No avatar selected"}),e.jsx("p",{children:s?`${s} ${t}`:c})]})})}function R(){const{user:a}=N(),{t:s}=$(),t=a==null?void 0:a.username,[n,r]=(t==null?void 0:t.split(" "))||[],[l,p]=f.useState(n),[o,x]=f.useState(r),[c,u]=f.useState(null),{updateCurrentUser:v}=A(),m=`${l} ${o}`,U={username:m,profilePicture:c},y=s("settings");function b(i){var j;const d=(j=i.target.files)==null?void 0:j[0];d&&(d.type==="image/png"||d.type==="image/jpeg")?u(d):(g.error("Please choose a .png/.jpg file type",{className:"toast"}),u(null))}async function w(i){i.preventDefault(),I(c,m)||v(U)}return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"user-data-h2",children:y.title}),e.jsxs("div",{className:"user-data",children:[e.jsx("div",{className:"user-data-preview",children:e.jsx(L,{firstName:l,lastName:o,avatar:c,handleFileChange:b})}),e.jsxs("form",{onSubmit:w,className:"form-user",children:[e.jsx(h,{id:"first name",value:l,onChange:i=>p(i.target.value)}),e.jsx(h,{id:"last name",value:o,onChange:i=>x(i.target.value)}),e.jsx("div",{className:"form-btn",children:e.jsx("button",{className:"btn btn-form",children:"Submit"})})]})]})]})}function B(){return e.jsx("div",{className:"main-page-container",children:e.jsx("div",{className:"main-page",children:e.jsx("div",{className:"grid-settings",children:e.jsx(R,{})})})})}export{B as default};
