import{d as b,e as C,y as P,_ as j,z as N,r as d,j as e,B as w,v as S,A as h}from"./index-B1_m4qjL.js";function E(){const a=b(),{mutate:s,isPending:r}=C({mutationFn:n=>P(n),onSuccess:()=>{j.success("User updated succesfully",{className:"toast"}),a.invalidateQueries({queryKey:["user"]})},onError:n=>j.error(n.message,{className:"toast"})});return{isPending:r,updateCurrentUser:s}}function F(a,s){if(!a||!s)return"Please select an avatar and fill the username"}function $(a,s){const r=F(a,s);return r?(j.error(r,{className:"toast"}),!0):!1}function A({avatar:a,firstName:s,lastName:r,handleFileChange:n}){const{user:t}=N(),m=t==null?void 0:t.profilePicture,[l,p]=d.useState(null),o=`${S}/${m||""}`,f=t==null?void 0:t.username;return d.useEffect(()=>{if(a){const v=new FileReader;v.onload=c=>{var g;typeof((g=c.target)==null?void 0:g.result)=="string"&&p(c.target.result)},v.readAsDataURL(a)}else p(null)},[a]),e.jsx("div",{className:"profile-preview",children:e.jsxs("div",{className:"profile-preview-container",children:[l||m?e.jsxs("label",{className:"profile-preview-container-img",children:[e.jsx("input",{id:"avatarInput",type:"file",className:"profile-preview-container-btn-input",onChange:n}),e.jsx(w,{className:"profile-preview-container-btn-camera"}),e.jsx("img",{src:l||o,alt:"avatar"})]}):e.jsx("p",{children:"No avatar selected"}),e.jsx("p",{children:s?`${s} ${r}`:f})]})})}function D(){const{user:a}=N(),s=a==null?void 0:a.username,[r,n]=(s==null?void 0:s.split(" "))||[],[t,m]=d.useState(r),[l,p]=d.useState(n),[o,f]=d.useState(null),{updateCurrentUser:v}=E(),c=`${t} ${l}`,g={username:c,profilePicture:o};function U(i){var x;const u=(x=i.target.files)==null?void 0:x[0];u&&(u.type==="image/png"||u.type==="image/jpeg")?f(u):(j.error("Please choose a .png/.jpg file type",{className:"toast"}),f(null))}async function y(i){i.preventDefault(),$(o,c)||v(g)}return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"user-data-h2",children:"Update your account"}),e.jsxs("div",{className:"user-data",children:[e.jsx("div",{className:"user-data-preview",children:e.jsx(A,{firstName:t,lastName:l,avatar:o,handleFileChange:U})}),e.jsxs("form",{onSubmit:y,className:"form-user",children:[e.jsx(h,{id:"first name",value:t,onChange:i=>m(i.target.value)}),e.jsx(h,{id:"last name",value:l,onChange:i=>p(i.target.value)}),e.jsx("div",{className:"form-btn",children:e.jsx("button",{className:"btn btn-form",children:"Submit"})})]})]})]})}function L(){return e.jsx("div",{className:"main-page-container",children:e.jsx("div",{className:"main-page",children:e.jsx("div",{className:"grid-settings",children:e.jsx(D,{})})})})}export{L as default};
