import{d as x,e as h,q as N,_ as f,v as U,r as u,j as e,m as y,I as j}from"./index-ExHkUnsR.js";import{a as b}from"./index-oIsDgGD3.js";function C(){const a=x(),{mutate:s,isPending:t}=h({mutationFn:l=>N(l),onSuccess:()=>{f.success("User updated succesfully",{className:"toast"}),a.invalidateQueries({queryKey:["user"]})},onError:l=>f.error(l.message,{className:"toast"})});return{isPending:t,updateCurrentUser:s}}function P(a,s){if(!a||!s)return"Please select an avatar and fill the username"}function w(a,s){const t=P(a,s);return t?(f.error(t,{className:"toast"}),!0):!1}function S({avatar:a,firstName:s,lastName:t,handleFileChange:l}){const{user:r}=U(),o=r==null?void 0:r.profilePicture,[d,c]=u.useState(null),p=`${y}/${o||""}`,v=r==null?void 0:r.username;return u.useEffect(()=>{if(a){const m=new FileReader;m.onload=n=>{var i;typeof((i=n.target)==null?void 0:i.result)=="string"&&c(n.target.result)},m.readAsDataURL(a)}else c(null)},[a]),e.jsx("div",{className:"profile-preview",children:e.jsxs("div",{className:"profile-preview-container",children:[d||o?e.jsxs("label",{className:"profile-preview-container-img",children:[e.jsx("input",{id:"avatarInput",type:"file",className:"profile-preview-container-btn-input",onChange:l}),e.jsx(b,{className:"profile-preview-container-btn-camera"}),e.jsx("img",{src:d||p,alt:"avatar"})]}):e.jsx("p",{children:"No avatar selected"}),e.jsx("p",{children:s?`${s} ${t}`:v})]})})}function E(){const[a,s]=u.useState(""),[t,l]=u.useState(""),[r,o]=u.useState(null),{updateCurrentUser:d}=C(),c=`${a} ${t}`,p={username:c,profilePicture:r};function v(n){var g;const i=(g=n.target.files)==null?void 0:g[0];i&&(i.type==="image/png"||i.type==="image/jpeg")?o(i):(f.error("Please choose a .png/.jpg file type",{className:"toast"}),o(null))}async function m(n){n.preventDefault(),w(r,c)||d(p)}return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"user-data-h2",children:"Update your account"}),e.jsxs("div",{className:"user-data",children:[e.jsx("div",{className:"user-data-preview",children:e.jsx(S,{firstName:a,lastName:t,avatar:r,handleFileChange:v})}),e.jsxs("form",{onSubmit:m,className:"form-user",children:[e.jsx(j,{id:"first name",value:a,onChange:n=>s(n.target.value)}),e.jsx(j,{id:"last name",value:t,onChange:n=>l(n.target.value)}),e.jsx("div",{className:"form-btn",children:e.jsx("button",{className:"btn btn-form",children:"Submit"})})]})]})]})}function A(){return e.jsx("div",{className:"main-page-container",children:e.jsx("div",{className:"main-page",children:e.jsx("div",{className:"grid-settings",children:e.jsx(E,{})})})})}export{A as default};
